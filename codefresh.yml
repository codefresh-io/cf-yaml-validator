version: '1.0'

steps:

  install_dependencies:
    title: 'Installing testing dependencies'
    image: node:11.8.0
    commands:
    - yarn install --frozen-lockfile

  eslint:
    title: 'Running linting logic'
    image: node:11.8.0
    commands:
    - yarn eslint

  unit_tests:
    title: 'Running unit-tests'
    image: node:11.8.0
    commands:
      - yarn test

  deploy_to_npm:
    title: Publishing To Npm
    image: codefresh/npm-publish:master
    commands:
      - NPM_TOKEN=${{NPM_TOKEN}} npm run ci-publish
    when:
      branch:
        only: [ master ]
